(* Content-type: application/vnd.wolfram.cdf.text *)

(*** Wolfram CDF File ***)
(* http://www.wolfram.com/cdf *)

(* CreatedBy='Wolfram 14.2' *)

(*************************************************************************)
(*                                                                       *)
(*                                                                       *)
(*  This file was created under the Wolfram Enterprise licensing terms.  *)
(*                                                                       *)
(*       For additional information concerning CDF licensing see:        *)
(*                                                                       *)
(*        www.wolfram.com/cdf/adopting-cdf/licensing-options.html        *)
(*                                                                       *)
(*                                                                       *)
(*                                                                       *)
(*************************************************************************)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[      1060,         20]
NotebookDataLength[     12867,        273]
NotebookOptionsPosition[     11894,        246]
NotebookOutlinePosition[     12304,        262]
CellTagsIndexPosition[     12261,        259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "KirillBelov`CSockets`TCP`"}]], "Input",
 CellChangeTimes->{{3.952138631930855*^9, 3.952138641531458*^9}, {
  3.9521430765260563`*^9, 3.952143077250149*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4d740a09-61f3-2f4e-bce8-538563889850"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"server", "=", " ", 
  RowBox[{"CSocketOpen", "[", 
   RowBox[{"\"\<localhost\>\"", ",", " ", "8080"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9521430380682335`*^9, 3.9521430543208923`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"2e4636b6-a820-764f-a9b6-fb5dccb226b3"],

Cell[BoxData[
 RowBox[{"CServerObject", "[", "598332816", "]"}]], "Output",
 CellChangeTimes->{
  3.9521430561345367`*^9, 3.9521558356273937`*^9, 3.9521953255548553`*^9, 
   3.9521957713062744`*^9, 3.952195892439394*^9, 3.952196049227867*^9, 
   3.952196163199335*^9, {3.952196306286255*^9, 3.9521963223552856`*^9}, {
   3.952196938399149*^9, 3.952196962027899*^9}, 3.952197221468212*^9, 
   3.9521974031299095`*^9, 3.9521979161624737`*^9, 3.952198013513296*^9, {
   3.9521981022403393`*^9, 3.9521981107076435`*^9}, 3.952198256071661*^9, {
   3.95219832489106*^9, 3.9521983613006535`*^9}, 3.952198499978546*^9, 
   3.9521992605685596`*^9, 3.9522319811879444`*^9, 3.9522329495779114`*^9, 
   3.95309627912171*^9, 3.953179228755417*^9, 3.9531794331410217`*^9, 
   3.9531795403535786`*^9, 3.9531796002363167`*^9, 3.953180544281996*^9, 
   3.953180890928276*^9, 3.9531809335459003`*^9, 3.953181078232271*^9, 
   3.953181156052841*^9, 3.9531812089510326`*^9, 3.9531813003707485`*^9, 
   3.9545614699722385`*^9, 3.9545626797997932`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"ec828669-47fd-3444-9824-9194d57f3060"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"server", "[", "\"\<Socket\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.952196962662878*^9, 3.952196966424471*^9}, {
  3.952197125493677*^9, 3.9521971290689507`*^9}, {3.9521972245980167`*^9, 
  3.952197225699644*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"4b155990-9d09-1349-8dcf-747bb8e61cff"],

Cell[BoxData[
 RowBox[{"CSocketObject", "[", "1800", "]"}]], "Output",
 CellChangeTimes->{
  3.9521969669259834`*^9, 3.952197131279415*^9, 3.9521972261738834`*^9, 
   3.9521974057460938`*^9, 3.952197918181837*^9, 3.952198015257597*^9, {
   3.9521981022433453`*^9, 3.952198110718178*^9}, 3.952198256075081*^9, {
   3.952198324894182*^9, 3.9521983613114834`*^9}, 3.95219849998328*^9, 
   3.952198530731043*^9, 3.9521992605719337`*^9, 3.9522319824550495`*^9, 
   3.9522329560320873`*^9, 3.953096280231884*^9, 3.9531792326949844`*^9, 
   3.953179435863041*^9, 3.9531795403535786`*^9, 3.9531796002363167`*^9, 
   3.953180546338257*^9, 3.9531808909324627`*^9, 3.9531809335459003`*^9, 
   3.9531810782353687`*^9, 3.9531811560583572`*^9, 3.9531812089557495`*^9, 
   3.95318130037603*^9, 3.9545614715309944`*^9, 3.954562692827507*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"7d6eab7a-7bf8-8346-996c-50353c4d6c66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"server", "[", "\"\<Port\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.952143338860737*^9, 3.952143341816681*^9}, {
  3.952197110116091*^9, 3.9521971154529095`*^9}, {3.952197229850809*^9, 
  3.952197231041952*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"f5516474-b615-624d-a925-7fe51c0a149f"],

Cell[BoxData["8080"], "Output",
 CellChangeTimes->{
  3.952143342463602*^9, 3.95219643518536*^9, {3.9521971022389164`*^9, 
   3.9521971372399845`*^9}, 3.952197231573372*^9, 3.9521974079617023`*^9, 
   3.952197919971033*^9, 3.952198017047268*^9, {3.9521981022474403`*^9, 
   3.952198110720564*^9}, 3.9521982560786934`*^9, {3.9521983249061756`*^9, 
   3.9521983613147354`*^9}, {3.9521984999878883`*^9, 3.952198528220331*^9}, 
   3.952199260576933*^9, 3.9522319835941296`*^9, 3.9522329590595913`*^9, 
   3.9530962816532116`*^9, 3.9531792337569103`*^9, 3.953179437962038*^9, 
   3.953179540374338*^9, 3.9531796002560673`*^9, 3.9531805477198124`*^9, 
   3.9531808909329834`*^9, 3.9531809335718994`*^9, 3.953181078242277*^9, 
   3.953181156063463*^9, 3.953181208961006*^9, 3.9531813003911743`*^9, 
   3.9545614734700775`*^9, 3.954562693601652*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"c45365f9-52bf-9848-9622-99f092dc4575"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"server", "[", "\"\<Host\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9521974318058567`*^9, 3.9521974358962307`*^9}, {
  3.9521978899201603`*^9, 3.9521978912681866`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ed5d2948-8f99-6e46-a4d7-bb4cf352d8fd"],

Cell[BoxData["\<\"127.0.0.1\"\>"], "Output",
 CellChangeTimes->{{3.9521974162830505`*^9, 3.952197437879339*^9}, {
   3.9521979217094135`*^9, 3.952197925108591*^9}, 3.952198018904846*^9, {
   3.952198102250412*^9, 3.952198110732271*^9}, 3.9521982560894566`*^9, {
   3.952198324918728*^9, 3.952198361325573*^9}, {3.952198499997673*^9, 
   3.9521985257610416`*^9}, 3.9521992605799313`*^9, 3.952231986728895*^9, 
   3.952232964188362*^9, 3.953096282468033*^9, 3.953179237307356*^9, 
   3.953179443432165*^9, 3.953179540374338*^9, 3.9531796002560673`*^9, 
   3.9531805492147827`*^9, 3.953180890937702*^9, 3.9531809335766773`*^9, 
   3.9531810782452755`*^9, 3.9531811560747128`*^9, 3.953181208961006*^9, 
   3.953181300408945*^9, 3.9545614742311077`*^9, 3.954562695479601*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"6466967e-6dfa-ae40-b80f-16f292e9a35f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"server", "[", "\"\<Clients\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.952143057850931*^9, 3.952143086608919*^9}, 
   3.952195343601454*^9, {3.952198031463402*^9, 3.95219804118775*^9}, {
   3.9521985086731033`*^9, 3.952198521722267*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f350feac-5d65-0b45-959a-638af4e1b230"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CSocketObject", "[", "1856", "]"}], ",", 
   RowBox[{"CSocketObject", "[", "1836", "]"}], ",", 
   RowBox[{"CSocketObject", "[", "1868", "]"}], ",", 
   RowBox[{"CSocketObject", "[", "1864", "]"}], ",", 
   RowBox[{"CSocketObject", "[", "1848", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9521957775464344`*^9, 3.952195894026991*^9, 3.952196050949682*^9, 
   3.9521961646097527`*^9, 3.9521963237636604`*^9, 3.9521971394535637`*^9, 
   3.952197928490185*^9, {3.952198020741686*^9, 3.9521980419405766`*^9}, {
   3.9521981022616215`*^9, 3.952198110735338*^9}, 3.952198256094244*^9, {
   3.9521983249228153`*^9, 3.952198361328972*^9}, {3.952198500001423*^9, 
   3.9521985232531986`*^9}, 3.9521992605899334`*^9, 3.9522319880545273`*^9, 
   3.952232161620592*^9, 3.9522329677925377`*^9, 3.9530962833267097`*^9, 
   3.9531792393764553`*^9, 3.9531794526299667`*^9, 3.9531795403941593`*^9, 
   3.9531796002560673`*^9, 3.953180550015167*^9, 3.9531807359045296`*^9, 
   3.953180890937702*^9, 3.9531809335766773`*^9, 3.9531810782482815`*^9, 
   3.953181156080078*^9, 3.95318120897073*^9, 3.953181300424711*^9, 
   3.9531818218617764`*^9, 3.953182729548542*^9, 3.954561475421976*^9, 
   3.9545615463112545`*^9, 3.9545626963128967`*^9, 3.9545628037045784`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"19fb62b3-5919-ea43-93f0-3de0f64fcc0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SocketListen", "[", 
  RowBox[{"server", ",", " ", "func"}], "]"}]], "Input",
 CellChangeTimes->{{3.9522319934293976`*^9, 3.9522319986887894`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"bbba159c-e37d-4d48-a740-c4169e54b741"],

Cell[BoxData[
 RowBox[{"CSocketListener", "[", 
  RowBox[{
   InterpretationBox[
    RowBox[{"AsynchronousTaskObject", "[", "\<\"\"\>", ",", "1", ",", 
     RowBox[{" ", "<>"}], "]"}],
    AsynchronousTaskObject["", 1, 22120167055148656599]], ",", 
   RowBox[{"CServerObject", "[", "598332816", "]"}], ",", "func"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.9522320012100525`*^9, 3.9522329700798626`*^9, 
  3.9530962860589542`*^9, 3.953179242421852*^9, 3.9531794573250465`*^9, 
  3.953179540414318*^9, 3.95317960027656*^9, 3.9531805559326515`*^9, 
  3.953180890958397*^9, 3.953180933598215*^9, 3.9531810782592964`*^9, 
  3.9531811561356487`*^9, 3.953181208982136*^9, 3.953181300438223*^9, 
  3.9545614811095715`*^9, 3.954562698208824*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"3c622f9d-3368-0a4d-8749-516242059edc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"resp", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringToByteArray", "[", 
        RowBox[{"\"\<HTTP/1.1 200 OK\\r\\n\\\nContent-Type: image/png\\r\\n\\\
\nContent-Length: \>\"", " ", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"Length", "[", "#", "]"}], "]"}], " ", "<>", 
         " ", "\"\<\\r\\n\\r\\n\>\""}], "]"}], " ", "~", " ", "Join", " ", "~",
        " ", "#"}], "&"}], " ", "@", " ", 
     RowBox[{"ExportByteArray", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Circle", "[", "]"}], ",", " ", 
         RowBox[{"ImageSize", "->", "20"}]}], "]"}], ",", 
       " ", "\"\<PNG\>\""}], "]"}]}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.9531011933954144`*^9, 3.953101197807045*^9}, {
  3.9531813915347023`*^9, 3.9531814003262386`*^9}, {3.9531814653430424`*^9, 
  3.9531815386689034`*^9}, {3.9531816070718822`*^9, 3.9531816203455276`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"d7ca60c6-d644-7a44-8b7d-3e7608778f25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"func", "[", "assoc_", "]"}], " ", ":=", " ", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Echo", "[", "assoc", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"BinaryWrite", "[", 
     RowBox[{
      RowBox[{"assoc", "[", "\"\<SourceSocket\>\"", "]"}], ",", "resp"}], 
     "]"}], ";"}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.9522320039645977`*^9, 3.952232056907093*^9}, {
   3.9522320900319576`*^9, 3.952232114115364*^9}, {3.9530975139812946`*^9, 
   3.9530975153326473`*^9}, 3.953097571679735*^9, {3.953097631446184*^9, 
   3.9530976947337914`*^9}, {3.953099048360817*^9, 3.95309909671933*^9}, {
   3.953099185658001*^9, 3.953099218535885*^9}, 3.953099280636116*^9, {
   3.9531011904401054`*^9, 3.953101200905895*^9}, {3.953179318390236*^9, 
   3.9531793314707603`*^9}, {3.953180935697956*^9, 3.953180937895981*^9}, {
   3.953181545659334*^9, 3.953181547268965*^9}, {3.9531816389911213`*^9, 
   3.9531816413171806`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"bc65634c-6167-7d4f-b5fc-502b80fd01be"]
},
WindowSize->{835.5, 430.5},
WindowMargins->{{Automatic, 86.25}, {Automatic, 269.25}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8a6c8a9d-ef93-c747-be85-30cc190643cc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[1460, 33, 264, 4, 28, "Input",ExpressionUUID->"4d740a09-61f3-2f4e-bce8-538563889850"],
Cell[CellGroupData[{
Cell[1749, 41, 293, 5, 28, "Input",ExpressionUUID->"2e4636b6-a820-764f-a9b6-fb5dccb226b3"],
Cell[2045, 48, 1108, 16, 32, "Output",ExpressionUUID->"ec828669-47fd-3444-9824-9194d57f3060"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3190, 69, 318, 5, 28, "Input",ExpressionUUID->"4b155990-9d09-1349-8dcf-747bb8e61cff"],
Cell[3511, 76, 903, 13, 32, "Output",ExpressionUUID->"7d6eab7a-7bf8-8346-996c-50353c4d6c66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4451, 94, 314, 5, 28, "Input",ExpressionUUID->"f5516474-b615-624d-a925-7fe51c0a149f"],
Cell[4768, 101, 919, 13, 32, "Output",ExpressionUUID->"c45365f9-52bf-9848-9622-99f092dc4575"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5724, 119, 271, 4, 28, "Input",ExpressionUUID->"ed5d2948-8f99-6e46-a4d7-bb4cf352d8fd"],
Cell[5998, 125, 848, 11, 32, "Output",ExpressionUUID->"6466967e-6dfa-ae40-b80f-16f292e9a35f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6883, 141, 341, 5, 28, "Input",ExpressionUUID->"f350feac-5d65-0b45-959a-638af4e1b230"],
Cell[7227, 148, 1384, 22, 51, "Output",ExpressionUUID->"19fb62b3-5919-ea43-93f0-3de0f64fcc0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8648, 175, 249, 4, 28, "Input",ExpressionUUID->"bbba159c-e37d-4d48-a740-c4169e54b741"],
Cell[8900, 181, 817, 15, 32, "Output",ExpressionUUID->"3c622f9d-3368-0a4d-8749-516242059edc"]
}, Open  ]],
Cell[9732, 199, 1074, 24, 85, "Input",ExpressionUUID->"d7ca60c6-d644-7a44-8b7d-3e7608778f25"],
Cell[10809, 225, 1081, 19, 85, "Input",ExpressionUUID->"bc65634c-6167-7d4f-b5fc-502b80fd01be"]
}
]
*)

